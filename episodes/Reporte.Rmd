---
title: "Report and Technical Reports in R Markdown"
authors: [""]
date: '2024-07-31'
output:
  pdf_document: default
  html_document: 
    self_contained: true
  word_document: default
image: null
licenses: CC-BY
teaching: 40
exercises: 4
editor_options: 
  markdown: 
    wrap: 72
---

::: questions

- How to use R Markdown to present a report?

:::

::: objectives

At the end of this workshop you will be able to:

- Recognize the importance of generating reports in R Markdown
- Learn to use R Markdown in a basic way

:::

::: prereq
This unit has the following prerequisites:

- Introduction to R and RStudio
:::


::: checklist
### Table of Contents

- Module: Data Science in Public Health
    - Unit: Report and Technical Reports in R Markdown
        - Topic 1: What is R Markdown?
        - Topic 2: Structure of R Markdown
        - Topic 3: Step by Step in R Markdown
        
:::

## Introduction

In this unit, we will learn about the use of the R Markdown format, which allows integrating code into the generation of reports without the need to import graphs or create tables manually. In this way, the R Markdown format facilitates the automatic generation, updating, and writing of technical reports by combining the syntax of the Markdown format with embedded R code in the document.

## **Topic 1: What is R Markdown?**

R Markdown is an extension of the Markdown format that allows combining text with embedded R code in the document. In this way, the analyses and visualizations generated by the code can be naturally incorporated into the text.

R Markdown is widely used by data scientists, analysts, researchers, and professionals who need to present their analyses and results clearly and reproducibly. Additionally, it is a very valuable tool for generating automated reports and interactive technical documents.

## **Topic 2: Structure of R Markdown**

An R Markdown document consists of three main types of elements:

1. **Yaml:** Corresponds to style specifications of the document, title, date, authors, etc.

2. **Text:** Rich text with formatting and explanations.

3. **Chunk:** Block of R code where the code is executed, and its results are shown.

![](fig/partes_reporte.png)

## **Topic 3: Step by Step in R Markdown**

Next, we will follow a step-by-step guide to create an R Markdown.

### **Step 1.** Open R Studio from R Project

According to what was learned in the Introduction to R and RStudio unit, it is advisable to have an R project where the R Markdown report will be hosted. Open an R Project and continue with Step 2.

### **Step 2. Create a new R Markdown file**

Following the path **File** > **New File** > **R Markdown**, we can create an R Markdown file by defining: title, author(s), and preferred output format (html, pdf, or word).

Follow the steps, which can also be seen in the image, and create your R Markdown file with your name and the title of Report.

![](fig/crea_reporte.png)

### **Step 3. Edit the R Markdown file and the code**

::: callout
It is important to remember that R Markdown has three sections, all editable: Yaml, Text, and Chunk of code.
:::

When you have created your R Markdown file, you will be able to observe and identify the different sections shown in the image.

![](fig/partes_reporte.png)

Next, we will see how to edit each of these parts:

#### **How to edit the text?**

- To include the title of a section, write the hash symbol # followed by the name of the section on a single line.

- To put subtitles, use two hash symbols ##.

- For each subtitle in the structure, add another hash symbol

    1.  

- To write a word in bold, use two asterisks on each side **word**

- To write a word in italics, use one asterisk on each side *word*

- To place the text in a separate block, precede this text with the symbol > on a single line.

#### **How to edit the *chunk* of code?**

To include R code, it is necessary to insert a *chunk* in the document by clicking on the green +C icon in the toolbar, as shown in the following image.

By clicking on this icon, a space delimited by the following symbols will appear, corresponding to the *chunk:*

```` ```{r} ````

```` ``` ````

After creating the chunk, we need to load the libraries for this practice. In the chunk, we load the libraries to be used in R. In this case, we will need two

```` ```{r} ````

```{r message=FALSE}
library(tidyverse)

library(knitr)
```

```` ``` ````

Now we need to run the Chunk by clicking on the "Run" icon and selecting the Chunk we want to run.

![](fig/run_siguiente.png)

Another option is to click on the green play icon located at the top right of each Chunk.

![](fig/run_actual.png)

#### **Specify chunk configuration**

Within a "chunk," we can choose whether we want the code to be displayed in the printed report or not by using the commands "echo = FALSE" (to hide it) or "echo = TRUE" (to show it).

The following table includes other options that can be used to configure a chunk. The table shows which types of outputs are suppressed when each option is specified as FALSE:

![](fig/tabla_bloque.png)

For example, in our practice, we will specify that the code is executed, as shown here.

```` ```{r, eval = TRUE} ````

```` ``` ````

#### **Create tables in R Markdown**

::: callout
The data table for this practice will be the same as the one used in the Introduction to Data Visualization in R with `ggplot2` unit. You can find it at:
<https://github.com/TRACE-LAC/TRACE-LAC-data/blob/main/otros/muestra_covid.RDS?raw=true>
:::

To create tables in R Markdown, we can use the `kable` function from the `knitr` library, as shown below:

```{r eval=FALSE, message=FALSE}
library(knitr)
library(tidyverse)

dat <- readRDS("data/muestra_covid.RDS")

covid_paises <- dat %>% 
  group_by(nombre_del_pais) %>% 
  summarise (casos = n()) %>% 
  filter (casos > 300)

kable(covid_paises)
```

As a result, we get the following table:

```{r echo=FALSE}
library(knitr)

dat <- readRDS("data/muestra_covid.RDS")

covid_paises <- dat %>% 
  group_by(nombre_del_pais) %>% 
  summarise (casos = n()) %>% 
  filter (casos > 300)
kable(covid_paises)
```

#### **Insert automated parameters in the text**

In a report, it is also possible to combine code and text, using the results obtained in the code as part of the report text. That is, to avoid having to manually enter a result in the report text, we can use the result obtained when running the chunk and make this result appear in the text automatically. To do this, simply parameterize a value and then include it in the text using its corresponding name.

For example, to calculate the total number of female COVID-19 cases in our `dat` dataset within an R chunk, we would do the following:

```{r}
total_casos_fem <- nrow(dat %>% filter (sexo == "femenino"))
```

Now, if we want to include this result in the report text, we must specify the parameter we want to use in this way `r total_casos_fem`, and for example, write directly as text:

The total number of female cases is `r total_casos_fem`

Whose value should match the value we get when printing the `total_casos_fem` object

```{r}
total_casos_fem
```

::: callout
When knitting the report, we will have a line similar to this:

The total number of female cases is `r total_casos_fem`

To see how the result of the code is combined with this text, we must follow the next step.
:::

### **Step 4. "Knit" (generate) the report**

To "knit" the report, that is, to generate the report in a specific format (HTML, PDF, or Word), we must click on the "Knit" symbol at the top of the R Markdown file editor. As shown in the following image:

![](fig/tejer.png)

After this step, the final report should appear in the selected presentation (html, pdf, or word).

::: challenge
Observe how the table and the text of the total number of female cases appear.
:::

Congratulations, you have produced your first R Markdown report in html!

 <center>  
   
[![](fig/dudas.png){width="100"}](https://epiverse-trace.github.io/epitkit/Banco_errores.html)  
  
</center>

::: keypoints

Check if at the end of this lesson you have acquired these skills:

- Recognize the importance of generating reports in R Markdown
- Learn to use R Markdown in a basic way

:::

### Contributions

- Zulma M. Cucunuba: Initial version
- Laura Gómez-Bermeo: Editing
- Geraldine Gomez: Minor edits
- Andree Valle: Minor edits
- José M. Velasco España: Minor edits

### Legal Issues

**Copyright**: Zulma M. Cucunuba, 2019
